# 摘要

本文主要叙述在篇一的基础上做的新改进。

## 产品功能演示

视频演示地址：【QT教程之markdown输入表情工具开发-QClipboard篇2-哔哩哔哩】 https://b23.tv/e0cLLBW。

## 主要新增功能：系统剪贴板的处理

1、QClipboard简介

:sunglasses:获取系统剪贴板对象。不用考虑delete。

2、设计

版本一：点击表情->字符串存到系统剪贴板->用户ctrl+v粘贴表情

版本二：点击表情->字符串自动粘贴表情到鼠标指针位置

## 涉及到技术刨析：

版本一：主要是QClipboard。

方案：QTableView的编辑单元格事件，捕获到emoj的字符串信息，将字符串拷贝至系统剪贴板。用户负责将剪贴板的数据粘贴到鼠标指针位置。

版本二：键盘钩子+鼠标当前位置+鼠标句柄+窗口消息（涉及windows技术更底层些）。

（1）插入表情时，双击键盘ctrl键存储鼠标指针的位置。

（2）根据鼠标位置解析窗口句柄

（3）用户点击testEmoj进程的某个表情

（4）向窗口发送消息。



# 小细节

QTableView设置列宽不起作用。原因是调用位置出错，填充完数据之后再设置列宽。把设置列宽理解为调整手动调整列宽就顺理多了。我们一般是数据看不见的时候才调整列宽，而不是先调整好列宽再填数据。

